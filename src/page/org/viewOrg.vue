<template>
  <div class="custom-tree-container orgTreeClass" v-loading="loading">
    <el-scrollbar style="height: 100%">
      <el-tree
        :data="data"
        ref="tree"
        node-key="id"
        default-expand-all
        highlight-current
        :props="defaultProps"
        @node-click="handleNodeClick"
        :expand-on-click-node="false"
      >
      <span class="custom-tree-node" slot-scope="{ node, data }">
        <span><i :class="data.icon"></i> {{node.label}}</span>
      </span>
      </el-tree>
    </el-scrollbar>
  </div>
</template>

<script>
  import * as utils from '../../utils/utils'

  export default {
    name: "viewOrg",
    data() {
      return {
        data: [],
        defaultProps: {
          children: 'childList',
          label: 'ogName'
        },
        loading: true
      }
    },
    methods: {
      handleNodeClick(data) {
        this.$emit('_handleOnClickOrg', data.id, data.ogId, data.level, data.modelType);
      },
      _getCurrentNode(){
        return this.$refs.tree.getCurrentNode();
      },
      _getUserRoleOrgTree() {
        this.$http({
          url: "/api/api/user/getUserRoleOrgTree",
          "content-type": "application/json",
          method: 'get',
          /*headers: {Authorization: token},*/
        }).then(res => {
          if (res.data.status == 1) {
            this.loading = false;
            this.data = res.data.result;
          } else {
            //TO-DO 临时先这么写提醒吧 哈哈哈哈
            this.loading = false;
            alert(res.data.msg);
            this.$router.push({path: "/"});
          }
        })
      }
    },
    mounted() {
      this._getUserRoleOrgTree();
    }

  }
</script>

<style lang="less" scoped>
  .custom-tree-container {
    height: calc(~"100%");
    flex: 1;
    align-items: center;
    justify-content: space-between;
    font-size: 14px;
    padding-block: 0px;
    /*padding-right: 8px;*/
    background-color: ghostwhite;
  }

</style>

<style>
  /*.el-tree-node:focus > .el-tree-node__content {
    !*background: -moz-linear-gradient(right,#FF9933, #42b983);*!
    background-color: #ffd30b !important;
    color: white;
  }*/

  .el-tree--highlight-current .el-tree-node.is-current > .el-tree-node__content {
    background-color: #ffd30b;
  }

  .el-scrollbar .el-scrollbar__wrap {
    overflow-x: hidden;
    overflow-y: visible;
    /*background-color: #b5b6b9;*/
  }

  .orgTreeClass .el-tree > .el-tree-node {
    min-width: 100%;
    height: 370px;
    font-size: 15px;
    display: inline-block;
    background-color: ghostwhite;
  }
</style>
